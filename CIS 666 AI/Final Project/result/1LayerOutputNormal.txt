PS D:\GitHub\cis-492-midterm\Final Project> & C:/Users/serey/AppData/Local/Programs/Python/Python39/python.exe "d:/GitHub/cis-492-midterm/Final Project/student_math_1layer.py"
Old dataframe
    school sex  age address famsize Pstatus  Medu  Fedu      Mjob      Fjob  reason  ... romantic  famrel  freetime  goout Dalc Walc health absences  G1  G2  G3
0       GP   F   18       U     GT3       A     4     4   at_home   teacher  course  ...       no       4         3      4    1    1      3        6   5   6   6
1       GP   F   17       U     GT3       T     1     1   at_home     other  course  ...       no       5         3      3    1    1      3        4   5   5   6
2       GP   F   15       U     LE3       T     1     1   at_home     other   other  ...       no       4         3      2    2    3      3       10   7   8  10
3       GP   F   15       U     GT3       T     4     2    health  services    home  ...      yes       3         2      2    1    1      5        2  15  14  15
4       GP   F   16       U     GT3       T     3     3     other     other    home  ...       no       4         3      2    1    2      5        4   6  10  10
..     ...  ..  ...     ...     ...     ...   ...   ...       ...       ...     ...  ...      ...     ...       ...    ...  ...  ...    ...      ...  ..  ..  ..
390     MS   M   20       U     LE3       A     2     2  services  services  course  ...       no       5         5      4    4    5      4       11   9   9   9
391     MS   M   17       U     LE3       T     3     1  services  services  course  ...       no       2         4      5    3    4      2        3  14  16  16
392     MS   M   21       R     GT3       T     1     1     other     other  course  ...       no       5         5      3    3    3      3        3  10   8   7
393     MS   M   18       R     LE3       T     3     2  services     other  course  ...       no       4         4      1    3    4      5        0  11  12  10
394     MS   M   19       U     LE3       T     1     1     other   at_home  course  ...       no       3         2      3    3    3      5        5   8   9   9

[395 rows x 33 columns]
New dataframe
     school  sex  age  address  famsize  Pstatus  Medu  Fedu  Mjob  Fjob  reason  ...  romantic  famrel  freetime  goout  Dalc  Walc  health  absences  G1  G2  G3
0         0    0   18        0        0        0     4     4     0     0       0  ...         0       4         3      4     1     1       3         6   5   6   6
1         0    0   17        0        0        1     1     1     0     1       0  ...         0       5         3      3     1     1       3         4   5   5   6
2         0    0   15        0        1        1     1     1     0     1       1  ...         0       4         3      2     2     3       3        10   7   8  10
3         0    0   15        0        0        1     4     2     1     2       2  ...         1       3         2      2     1     1       5         2  15  14  15
4         0    0   16        0        0        1     3     3     2     1       2  ...         0       4         3      2     1     2       5         4   6  10  10
..      ...  ...  ...      ...      ...      ...   ...   ...   ...   ...     ...  ...       ...     ...       ...    ...   ...   ...     ...       ...  ..  ..  ..
390       1    1   20        0        1        0     2     2     3     2       0  ...         0       5         5      4     4     5       4        11   9   9   9
391       1    1   17        0        1        1     3     1     3     2       0  ...         0       2         4      5     3     4       2         3  14  16  16
392       1    1   21        1        0        1     1     1     2     1       0  ...         0       5         5      3     3     3       3         3  10   8   7
393       1    1   18        1        1        1     3     2     3     1       0  ...         0       4         4      1     3     4       5         0  11  12  10
394       1    1   19        0        1        1     1     1     2     4       0  ...         0       3         2      3     3     3       5         5   8   9   9

[395 rows x 33 columns]
X_train:  (316, 26)
y_train:  (1, 316)
X_test:  (79, 26)
y_test:  (1, 79)
start
7 8.3949075726692
13 7.291251502302421
10 9.360606634240137
10 10.602219713402766
9 9.084692616648441
11 12.947488862932177
12 9.498563643035984
11 8.3949075726692
11 10.188348687015225
12 10.740176722198614
13 9.360606634240137
12 10.050391678219373
0 10.878133730994461
12 9.774477660627678
7 10.188348687015225
8 10.878133730994461
9 11.42996176617785
13 9.912434669423527
12 11.843832792565397
15 9.360606634240137
12 9.77447766062768
10 10.32630569581107
10 11.292004757382003
12 11.292004757382003
0 9.636520651831832
12 10.188348687015221
8 9.360606634240137
15 10.464262704606918
13 10.740176722198612
14 13.913187924503113
9 10.188348687015225
9 11.5679187749737
18 11.843832792565397
10 8.256950563873353
14 10.050391678219375
10 7.981036546281658
8 11.981789801361243
10 12.257703818952939
8 10.46426270460692
10 10.050391678219375
9 12.395660827748788
13 12.257703818952939
8 11.843832792565394
6 7.705122528689964
5 11.843832792565397
0 9.774477660627678
13 11.567918774973698
11 12.11974681015709
14 11.154047748586155
0 9.084692616648441
11 10.602219713402768
16 9.77447766062768
16 11.42996176617785
8 9.498563643035984
0 10.464262704606917
12 9.222649625444289
5 10.188348687015221
11 11.42996176617785
14 9.498563643035984
12 10.740176722198616
12 10.32630569581107
8 11.705875783769548
10 9.222649625444289
10 11.01609073979031
14 10.464262704606918
10 11.705875783769546
13 11.843832792565394
10 9.084692616648441
13 9.084692616648441
12 12.947488862932177
0 10.464262704606918
11 8.532864581465049
12 9.222649625444289
10 9.912434669423527
10 18.051898188378548
8 10.602219713402766
9 10.050391678219375
9 9.636520651831832
12 8.946735607852593
[12482.0, 1.579670654580546, 2.0404093534718344, 50.22206105639844, 13.269831861788752, 0.17677520724021903, 15.665645222528923, 7.122145405148959, 37.92458903594544, 4.011151836030765, 0.31277475738773414, 38.43398992556258, 7.884356027580328, 14.323268233760158, 29.800689233123496, 51.25819821141576, 6.727158358476013, 9.223985502925055, 4.208386421206919, 19.98338601458332, 1.8639311232335891, 3.0130542945507344, 0.7989543407181676, 0.8837180417057638, 71.21877475276453, 3.1783209273370585, 57.36069381503143, 0.6526631189399588, 1.0386874623843314, 1.751501043676714, 22.465936000207655, 0.9446199438282536, 7.215851498531742e-05, 7.417208488536308, 49.01432387950735, 1.8109323635827237, 4.771512291963802, 0.8481464335227173, 0.28181172822782635, 9.499816487465411, 0.6647301294750799, 0.9613734807273697, 0.8997182644089234, 3.8485338707892103, 1.6502678487392224, 0.21489098261990683, 39.499436847736376, 0.7189146607943475, 3.5128187045494306, 49.4111342702199, 60.803593466345134, 0.34061902769190283, 37.78922617266741, 1.5663144573035124, 6.301795190908711, 1.0565971211310246, 18.73181897201581, 6.5389378328354475, 20.207867065295545, 1.4627459978893556, 1.484227651676829, 4.797800605012299, 1.784504807117512, 49.03190230160679, 0.3719114192357858, 12.124921392520378, 21.78407677124735, 35.789765622971004, 45.458221958063355, 5.179014300166627, 0.17080563292742784, 0.5453248891890634, 13.164648671317588, 3.506611962122194, 5.023250380958002, 16.0153927579403, 4.56639706697225, 44.296595877074886, 3.2610434999805413, 6.999881551884217, 1.352355690551003, 1.0423527575189657, 52.4784380039011, 13.408950836553263, 0.09421038690016838, 14.395787097236125, 6.377363402455223, 36.81666709203491, 3.5171337420079145, 0.365090139959393, 42.35920992335895, 8.437732206292205, 20.31893605810086, 43.38583759369835, 61.539951489278266, 7.84823349821316, 9.742821469704861, 1.7888442424807953, 17.453249734884327, 1.516801519155232, 1.6476962577369194, 0.2685237322432032, 1.3009669671730142, 59.70981227672272, 4.4236746855975335, 64.52396206504639, 0.4629579732307, 0.9606496527214531, 1.4709350753120864, 16.957448009420595, 0.30606342733329306, 0.014164918036965518, 10.808701587805325, 59.72769761998975, 1.7637058579214921, 4.450754240719769, 0.0473381535865178, 1.7867753556173416, 6.01149075700329, 1.5223093988255119, 1.329512041499195, 0.44299091530573365, 2.152091853507813, 1.524141817663204, 0.08244319409532262, 31.0192969377496, 0.13493068313804327, 2.3091328452663324, 71.82956799219532, 74.44465417757628, 0.2661800909050346, 41.01030355022695, 0.642791105556626, 8.586500344713787, 0.6564357454111015, 14.040677265329741, 8.233163947192823, 20.38114498713381, 2.328785597283579, 0.004252598261485131, 4.238273996764346, 1.9975071895503795, 57.5525434497652, 1.9884171701312963, 27.50374726894716, 12.059739411659137, 36.05798545341412, 54.09920128880589, 5.511340961340528, 1.0430663246911436, 0.47525174957187083, 18.035907751304148, 1.3266044607663183, 5.130161800852249, 13.757625223843874, 15.991943973627862, 41.50477433404354, 3.279991124603367, 4.6357031506687605, 0.1412989100489937, 7.84922155249321, 64.54341362799443, 11.549918567751067, 0.09232772642098648, 14.380733750912485, 10.404385639761431, 39.37942441818086, 8.449756510669229, 0.2037457003569253, 40.92071916896103, 8.164861518975941, 6.4383944245514835, 43.604985553310456, 76.84154644212585, 5.250021949836912, 6.706868980531765, 0.08510769376476615, 11.358190573257314, 1.0759358830444652, 0.23320645266948806, 0.3411577982911958, 2.0258512794958854, 46.40120895954058, 1.5662815467396418, 60.84056023709496, 1.0959855745807598, 0.5895479037481901, 5.3318802301103165, 14.82106961307426, 3.1578761815463396, 0.3648269120471709, 15.5309713090668, 71.44990086581396, 0.8900204878500824, 6.1500885981426245, 0.004036655691586322, 1.4632125298862804, 5.212488396041208, 0.7676622505434488, 0.13305453311434112, 0.35277842337566384, 2.3076759662213537, 1.9089473431431065, 0.19601200437089636, 30.784989565852953, 0.5050043836727148, 3.2039113522120344, 76.45333923808641, 77.98122125587345, 0.3633054126833739, 41.578591819010896, 0.5794011252085475, 8.16037626448791, 0.5508955637840716, 14.574900041621172, 7.883221414430488, 20.105603567447194, 2.073825243282746, 0.007044811708701283, 4.153549197137447, 2.203598191922068, 57.93825286538067, 
2.1230976604133356, 28.06483183452067, 11.93512207949579, 36.01861979512515, 54.3344218594619, 5.513224556763606, 1.086723997363614, 0.5072004431096541, 17.84340303178008, 1.4070827694592092, 5.321100401736459, 14.004795458987424, 15.725652677810576, 43.492637343485306, 3.2722828074969414, 4.764807404294682, 0.14367292149008612, 8.075640148704979, 64.67754191288607, 11.434405947841755, 0.11518512150785654, 14.513989785511225, 10.579599134487966, 39.817958712148084, 8.351712233919452, 0.23251476909668875, 40.660083756745536, 8.420229454930936, 6.800287406590083, 44.45089442516178, 77.33275557599386, 5.331947127447632, 6.743579530121197, 0.10447900571753775, 11.30992222366915, 1.1206685734473438, 0.2256777211599359, 0.3735543355494327, 2.1339201619525174, 46.30806104100506, 1.6022396408074724, 61.16292157637709, 1.1390574619101523, 0.5234962582816641, 5.4059182752694435, 14.853810390153908, 3.392757144807172, 0.3671969536321313, 15.62888266437632, 71.77450612542542, 0.921853544953554, 6.2149369192659805, 0.007418405605242693, 1.5369630558219944, 5.062934065615888, 0.7108499145938459, 0.12626960685504798, 0.3705894989570068, 2.4072177072647265, 1.9349509681454637, 0.16959475763599757, 30.523609639292925, 0.5353086650157924, 3.253187525449495, 76.97307602707943, 78.43651609674528, 0.34709192537136685, 41.209891289985606, 0.5977424794691977, 8.040886382458536, 0.5235644554185089, 14.778374617980907, 7.775449986599602, 20.154048683345103, 1.940018619510976, 0.005600240182898418, 4.1910874175192285, 2.324231090727981, 57.93868465678247, 2.1914079565764677, 28.407544878381877, 11.90570141984475, 36.08597329094872, 54.4666668975452, 5.4924723853666855, 1.1411187454711067, 0.535139124460578, 17.679048199518505, 1.4825933139414373, 5.503783255544027, 14.23759942109354, 15.477455991206169, 45.53464227300038, 3.256063141063903, 4.908345766486513, 0.14749632526240491, 8.302732451378587, 64.79772477370162, 11.310898250376468, 0.14101080740322505, 14.655095346056891, 10.764266142478558, 40.27680673951216, 8.252577273588455, 0.2639477735223782, 40.38878773580486, 8.686601747315224, 7.183140019390681, 45.32977075533655, 77.83778296829735, 5.418097216857341, 6.782414792325419, 0.12650371079037093, 11.2607374026903, 1.1680232938021904, 0.21806524260594398, 0.4086001325529203, 2.2485982008612515, 46.21212407033335, 1.6399026135712658, 61.49744205906849, 1.1844835167092818, 0.45930170414532745, 5.483115949307216, 14.888037803415562, 3.6442272665704056, 0.36963172767092023, 15.730299953283147, 72.11061880158876, 0.9553599457334144, 6.2821979723805335, 0.011989361127761777, 1.6150714325845124, 4.910710303726405, 0.6544671095510233, 0.11947041414592068, 0.3894178575076369, 2.512452779299726, 1.9620468279973426, 0.1442997148213786, 30.25491789043949, 0.5675180411021056, 3.304501281626693, 77.51215481080412, 78.90858823391955, 0.33072721615797007, 40.830176529786705, 0.6169681446421, 7.918112675733442, 0.4959862328974736, 14.990649838135045, 7.664518060194448, 20.2038148161379, 1.8063110941108385, 0.004279768058493244, 4.230107265579163, 2.452221766339196, 57.93848862485333, 2.263150303063602, 28.763996068082605, 11.87529437565246, 36.156249102309154, 54.60395546712772, 5.471194324537003, 1.1987057627080493, 0.5648949488241736, 17.509476720048198, 1.5628784006361918, 5.696133751268739, 14.480243309531208, 15.222990507258519, 47.69465382056216, 3.2392315180221294, 5.059148914126035, 0.15150596756337098, 8.540771882698596, 64.9221890431291, 11.183683210972273, 0.17048968129616476, 14.801494694970645, 10.956729351491841, 40.753468134783816, 8.150400864240623, 0.29860282575627367, 40.10969183302596, 8.966308944851503, 7.589941479846102, 46.24687653847148, 78.36105644010885, 5.507983324870682, 6.822709790353292, 0.1514986793283699, 11.21004462749738, 1.218059215960529, 0.21033286621410124, 0.4464519822133198, 2.3702372218565615, 46.113680175690675, 1.6794396782956706, 61.84507341312119, 1.2324645443767355, 0.3973345068655848, 5.563543834615324, 14.923698703782069, 3.9135178896992464, 0.37214963706881926, 15.835465474262001, 72.45885399071622, 0.9906268873190209, 6.3519958435848345, 0.017865730410708366, 1.6978067846721232, 4.7558901467174355, 0.5986833839062095, 0.11266964518940695, 0.4093214614801536, 2.6237507875397426, 1.9902834935094604, 0.1202998618283393, 29.978739753344076, 0.6017567404138688, 
3.357952827554692, 78.07138779854822, 79.39813117755953, 0.31423288308255204, 40.43917495183332, 0.6371250832713325, 7.791997428432091, 0.4682033029123853, 15.212168652901113, 7.550357644514266, 20.25492782022884, 1.6730286767228921, 0.0030999755675303648, 4.270674901611049, 2.5880408694041317, 57.937605001355195, 2.338519863362446, 29.134809266433578, 11.843866686340016, 36.229589634402195, 54.74649969281132, 5.449381464815992, 1.259684976561211, 0.5965967039553239, 17.33454250773028, 1.6482653761479247, 5.898735395240949, 14.733200000931065, 14.962182505718383, 49.9800731493384, 3.2217638564763953, 5.217640024182208, 0.15571230131489938, 8.790359342038379, 65.05109919094807, 11.052670218476045, 0.20394746835950595, 14.9534067778158, 11.157362988012117, 41.24871357667454, 8.04510810374176, 0.3367501944284761, 39.822608772800585, 9.260105259224572, 8.022268088784116, 47.204102067346135, 78.90328570212975, 5.601792825181567, 6.864525056014762, 0.17972167513606227, 11.157801176010459, 1.2709456047376684, 0.2024858941366241, 0.48731364354995155, 2.4992832217547303, 46.01268331796825, 1.7209604982539317]
MSE:  15.68385387429725


w1, w2, wn, theta, l = nn(10000, len(X_train.T), X_train, y_train, .0005)