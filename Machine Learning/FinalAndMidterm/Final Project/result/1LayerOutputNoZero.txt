PS D:\GitHub\cis-492-midterm\Final Project> & C:/Users/serey/AppData/Local/Programs/Python/Python39/python.exe "d:/GitHub/cis-492-midterm/Final Project/student_math_1layer.py"
Old dataframe
    school sex  age address famsize Pstatus  Medu  Fedu      Mjob      Fjob  reason  ... romantic  famrel  freetime  goout Dalc Walc health absences  G1  G2  G3
0       GP   F   18       U     GT3       A     4     4   at_home   teacher  course  ...       no       4         3      4    1    1      3        6   5   6   6
1       GP   F   17       U     GT3       T     1     1   at_home     other  course  ...       no       5         3      3    1    1      3        4   5   5   6
2       GP   F   15       U     LE3       T     1     1   at_home     other   other  ...       no       4         3      2    2    3      3       10   7   8  10
3       GP   F   15       U     GT3       T     4     2    health  services    home  ...      yes       3         2      2    1    1      5        2  15  14  15
4       GP   F   16       U     GT3       T     3     3     other     other    home  ...       no       4         3      2    1    2      5        4   6  10  10
..     ...  ..  ...     ...     ...     ...   ...   ...       ...       ...     ...  ...      ...     ...       ...    ...  ...  ...    ...      ...  ..  ..  ..
390     MS   M   20       U     LE3       A     2     2  services  services  course  ...       no       5         5      4    4    5      4       11   9   9   9
391     MS   M   17       U     LE3       T     3     1  services  services  course  ...       no       2         4      5    3    4      2        3  14  16  16
392     MS   M   21       R     GT3       T     1     1     other     other  course  ...       no       5         5      3    3    3      3        3  10   8   7
393     MS   M   18       R     LE3       T     3     2  services     other  course  ...       no       4         4      1    3    4      5        0  11  12  10
394     MS   M   19       U     LE3       T     1     1     other   at_home  course  ...       no       3         2      3    3    3      5        5   8   9   9

[357 rows x 33 columns]
New dataframe
     school  sex  age  address  famsize  Pstatus  Medu  Fedu  Mjob  Fjob  reason  ...  romantic  famrel  freetime  goout  Dalc  Walc  health  absences  G1  G2  G3
0         0    0   18        0        0        0     4     4     0     0       0  ...         0       4         3      4     1     1       3         6   5   6   6
1         0    0   17        0        0        1     1     1     0     1       0  ...         0       5         3      3     1     1       3         4   5   5   6
2         0    0   15        0        1        1     1     1     0     1       1  ...         0       4         3      2     2     3       3        10   7   8  10
3         0    0   15        0        0        1     4     2     1     2       2  ...         1       3         2      2     1     1       5         2  15  14  15
4         0    0   16        0        0        1     3     3     2     1       2  ...         0       4         3      2     1     2       5         4   6  10  10
..      ...  ...  ...      ...      ...      ...   ...   ...   ...   ...     ...  ...       ...     ...       ...    ...   ...   ...     ...       ...  ..  ..  ..
390       1    1   20        0        1        0     2     2     3     2       0  ...         0       5         5      4     4     5       4        11   9   9   9
391       1    1   17        0        1        1     3     1     3     2       0  ...         0       2         4      5     3     4       2         3  14  16  16
392       1    1   21        1        0        1     1     1     2     1       0  ...         0       5         5      3     3     3       3         3  10   8   7
393       1    1   18        1        1        1     3     2     3     1       0  ...         0       4         4      1     3     4       5         0  11  12  10
394       1    1   19        0        1        1     1     1     2     4       0  ...         0       3         2      3     3     3       5         5   8   9   9

[357 rows x 33 columns]
X_train:  (303, 26)
y_train:  (1, 303)
X_test:  (54, 26)
y_test:  (1, 54)
start
8 9.405140601173564
7 8.343900889364894
15 10.33372534900615
8 11.527620024790902
15 10.068415421053983
13 13.782754412384323
13 10.466380312982233
8 9.405140601173565
7 11.129655132862652
15 11.660274988766986
11 10.33372534900615
8 10.997000168886567
15 11.792929952743071
5 10.7316902409344
11 11.12965513286265
16 11.792929952743071
13 12.323549808647403
16 10.864345204910483
14 12.721514700575655
8 10.33372534900615
9 10.731690240934402
10 11.262310096838734
10 12.190894844671318
5 12.19089484467132
9 10.599035276958316
12 11.129655132862652
11 10.33372534900615
10 11.394965060814819
14 11.660274988766986
8 14.71133916021691
13 11.129655132862652
8 12.456204772623487
16 12.721514700575655
10 9.272485637197482
13 10.997000168886567
8 9.007175709245313
12 12.854169664551739
10 13.119479592503902
12 11.394965060814817
8 10.997000168886567
8 13.252134556479989
9 13.119479592503906
11 12.721514700575655
12 8.741865781293145
12 12.721514700575655
14 10.731690240934402
10 12.456204772623488
16 12.986824628527822
9 12.058239880695236
13 10.068415421053983
11 11.527620024790902
12 10.7316902409344
11 12.323549808647403
13 10.466380312982233
[12012.5, 152.18059537950145, 127.45592888797337, 69.92211841210919, 3.1642019761816593, 31.71776238544113, 12.917861995489941, 36.00926797556544, 17.506111670533045, 6.388699602289331, 0.5032492994162097, 0.8109952063943924, 0.8923186376651638, 4.664065309500296, 2.059810755256367, 23.408873500173677, 0.8763258683327405, 0.14903809960446973, 26.481831264789026, 1.9230124833873363, 2.170770408555112, 1.3689604953568069, 0.11085077980038537, 3.937940526766034, 7.688250615061169, 7.839832787306176, 10.598692072302983, 
10.909540727559442, 2.668359175220739, 19.461819351815475, 2.353916956354189, 2.192471856549411, 0.02474940779468571, 0.7764196832197051, 38.48750268751506, 4.304420932912316, 0.7109007548205315, 20.49436343277747, 0.0038898447446066237, 1.9063363176726068e-06, 6.067391634811515, 6.368712444602849, 5.686086640500038, 0.7626197716219373, 2.3541426333683533, 1.086731034252017, 0.26366363378115654, 7.471265409032568, 0.9895618166609202, 15.311577164826028, 14.443495804834848, 14.071495446368955, 3.9658523552059526, 3.0922899446039227, 15.429377721330889, 0.02325157862354874, 17.380333544224086, 14.969700729728135, 0.009254451678338587, 14.394863270284493, 0.04763991250323393, 11.950280682674006, 1.3063700515832917, 0.3085094197709422, 0.0010493235750312882, 0.8048304950309824, 6.253978395638544, 5.190425799389328, 0.06517338687444985, 29.49936799635354, 2.601949653627596, 6.19105576444658, 12.990359377610208, 1.9477414520619662, 0.04518338228511983, 1.1363200828038929, 10.174827015930065, 0.3879894157533918, 6.328093155670992, 14.848989333624157, 7.7732483954933125, 2.6905660084199066, 0.4796401626347165, 0.0694471806171326, 7.603376601273164, 21.826540821364077, 1.8066152813451286, 4.656200812069559, 
2.3981959382700064, 29.454690097044562, 0.402761095675135, 0.4481523378921929, 25.164359911498153, 9.806768085471226, 7.681507384033536, 8.547803216908449, 7.404031063002389, 15.366605461519411, 0.3500996910000082, 1.507101449039723]
MSE:  9.129091765710053

toBeRemovedList = ['G3', 'school', 'sex', 'address', 'guardian', 'paid', 'nursery']
# toBeRemovedList = ['G3']
y = newDF['G3'].to_numpy()
x = newDF.drop(toBeRemovedList, axis=1).to_numpy()
n = (len(np.transpose(x)))
featureN = len(x.T)
X_train, X_test, y_train, y_test = train_test_split(x, y, test_size=0.15, random_state=40)
y_train = y_train.reshape(1, len(y_train))
y_test = y_test.reshape(1, len(y_test))
print('X_train: ', X_train.shape)
print('y_train: ', y_train.shape)
print('X_test: ', X_test.shape)
print('y_test: ', y_test.shape)
print('start')
# w1, w2, wn, theta, l = nn(10000, len(X_train.T), X_train, y_train, .0005)
w1, w2, wn, theta, l = nn(2000, len(X_train.T), X_train, y_train, .0001)
predicted = nnPredict(w1, w2, wn, X_test, theta)

w1, w2, wn, theta, l = nn(2000, len(X_train.T), X_train, y_train, .0001)